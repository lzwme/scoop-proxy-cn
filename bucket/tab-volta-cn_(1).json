{
  "version": "1.0.0",
  "description": "Volta tab completion script in PowerShell",
  "homepage": "https://github.com/abgox/PS-completions",
  "license": "MIT",
  "url": "https://ghproxy.net/https://raw.githubusercontent.com/abgox/PS-completions/main/volta/volta-cn.ps1",
  "hash": "525de8ec7560a7505394cea6a3073ecd66246fec17d6e98dc8ae5a0cdae05bd3",
  "post_install": [
    "function checkProfile($oldPattern, $newContent) {",
    "   if (!(Test-Path $PROFILE)) { New-Item $PROFILE }",
    "   $profileContent = Get-Content $PROFILE",
    "   $foundOldContent = $false",
    "   for ($i = 0; $i -lt $profileContent.Count; $i++) {",
    "       if ($profileContent[$i] -match $oldPattern) {",
    "           $foundOldContent = $true",
    "           if ($Matches[0] -ne $newContent) {",
    "               $profileContent[$i] = $profileContent[$i] -replace $oldPattern, $newContent",
    "               echo \"\"",
    "               echo \"Replace Content(PROFILE):`noldContent:`n$oldPattern`nnewContent:`n$newContent\"",
    "           }",
    "       }",
    "   }",
    "   if (-not $foundOldContent) {echo \"\";$profileContent += $newContent;echo \"Add Content($PROFILE): `n    $newContent\"}",
    "   $profileContent | Set-Content -Path $PROFILE",
    "}",
    "   $oldPattern = \"cat.*.*volta-cn.*\\.ps1.*\\|.*Out-String.*\\|.*Invoke-Expression\"",
    "   $newContent = \"`ncat '$dir\\volta-cn.ps1' | Out-String | Invoke-Expression\"",
    "   checkProfile $oldPattern $newContent",
    "   $oldPattern = \"Set-PSReadLineKeyHandler.*Tab.*MenuComplete\"",
    "   $newContent = \"`nSet-PSReadLineKeyHandler -Key 'Tab' -Function MenuComplete\"",
    "   checkProfile $oldPattern $newContent"
  ],
  "post_uninstall": [
    "$pattern = \"cat.*volta-cn.*\\.ps1.*\\|.*Out-String.*\\|.*Invoke-Expression\"",
    "if (!(Test-Path $PROFILE)) { return }",
    "function RemoveProfileContent($pattern){",
    "   $profileContent = Get-Content $PROFILE",
    "   $newContent = @()",
    "   foreach ($line in $profileContent) {",
    "       if(($line -notMatch $pattern) -and (-not [string]::IsNullOrWhiteSpace($line))){",
    "               $newContent += $line",
    "       }",
    "   }",
    "   $newContent | Set-Content -Path $PROFILE",
    "}",
    "RemoveProfileContent $pattern"
  ],
  "checkver": {
    "url": "https://ghproxy.net/https://raw.githubusercontent.com/abgox/PS-completions/main/volta/volta-cn.ps1",
    "regex": "# @version.+v([\\d.]+)"
  }
}